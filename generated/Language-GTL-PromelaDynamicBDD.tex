\haddockmoduleheading{Language.GTL.PromelaDynamicBDD}
\label{module:Language.GTL.PromelaDynamicBDD}
\haddockbeginheader
{\haddockverb\begin{verbatim}
module Language.GTL.PromelaDynamicBDD (
    TransModel(TransModel,
               varsInit,
               varsIn,
               varsOut,
               stateMachine,
               checkFunctions), 
    TransProgram(TransProgram, transModels, transClaims, claimChecks), 
    deleteTmp,  verifyModel,  traceToAtoms,  varName,  translateContracts, 
    translateModel,  translateNever,  AtomCache,  OutputMapping,  parseGTLAtom, 
    parseGTLRelation,  createBDDAssign,  createBDDCompare,  BDDConst(bddConst), 
    createBDDExpr,  buildTransProgram
  ) where\end{verbatim}}
\haddockendheader

Implements a verification mechanism that abstracts components by using their
    contract to build a state machine that acts on BDD.
\par

\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
data\ TransModel
\end{tabular}]\haddockbegindoc
\haddockbeginconstrs
\haddockdecltt{=} & \haddockdecltt{TransModel} & \\
                    \{ & \haddockdecltt{varsInit :: Map String String} & \\
                    , & \haddockdecltt{varsIn :: Map String Integer} & \\
                    , & \haddockdecltt{varsOut :: Map String (Map (Maybe (String, String)) (Set Integer))} & \\
                    , & \haddockdecltt{stateMachine :: Buchi ([Integer], [Integer], [GTLAtom String])} & \\
                    , & \haddockdecltt{checkFunctions :: [String]} & \\
                    \} &
\end{tabulary}\par
An internal representation of a translated GTL model.
\par

\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
instance\ Show\ TransModel
\end{tabular}]
\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
data\ TransProgram
\end{tabular}]\haddockbegindoc
\haddockbeginconstrs
\haddockdecltt{=} & \haddockdecltt{TransProgram} & \\
                    \{ & \haddockdecltt{transModels :: Map String TransModel} & \\
                    , & \haddockdecltt{transClaims :: Buchi [Integer]} & \\
                    , & \haddockdecltt{claimChecks :: [String]} & \\
                    \} &
\end{tabulary}\par
An internal representation of a translated GTL program.
\par

\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
instance\ Show\ TransProgram
\end{tabular}]
\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
deleteTmp\ ::\ FilePath\ ->\ IO\ ()
\end{tabular}]\haddockbegindoc
Helper function to securely delete temporary files.
   Deletes a file if it exists, if not, ignore it.
\par

\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
verifyModel
\end{tabular}]\haddockbegindoc
\haddockbeginargs
\haddockdecltt{::} & \haddockdecltt{Bool} & Keep temporary files generated by spin, gcc, etc.
 \\
                                            \haddockdecltt{->} & \haddockdecltt{String} & Name of the GTL file without extension
 \\
                                                                                          \haddockdecltt{->} & \haddockdecltt{GTLSpec} & The GTL file contents
 \\
                                                                                                                                         \haddockdecltt{->} & \haddockdecltt{IO ()} & \\
\end{tabulary}\par
Do a complete verification of a given GTL file
\par

\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
traceToAtoms
\end{tabular}]\haddockbegindoc
\haddockbeginargs
\haddockdecltt{::} & \haddockdecltt{TransProgram} & The program to work on
 \\
                                                    \haddockdecltt{->} & \haddockdecltt{[(String, Integer)]} & The transitions, given in the form (model,transition-number)
 \\
                                                                                                               \haddockdecltt{->} & \haddockdecltt{Trace} & \\
\end{tabulary}\par
Given a list of transitions, give a list of atoms that have to hold for each transition.
\par

\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
varName\ ::\ Bool\ ->\ String\ ->\ String\ ->\ Integer\ ->\ String
\end{tabular}]\haddockbegindoc
Helper function to convert the name of a GTL variable into the
   translated C-representation.
\par

\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
translateContracts\ ::\ TransProgram\ ->\ {\char 91}Module{\char 93}
\end{tabular}]\haddockbegindoc
Convert a translated GTL program into a PROMELA module.
\par

\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
translateModel
\end{tabular}]\haddockbegindoc
\haddockbeginargs
\haddockdecltt{::} & \haddockdecltt{String} & The name of the model
 \\
                                              \haddockdecltt{->} & \haddockdecltt{TransModel} & The actual model
 \\
                                                                                                \haddockdecltt{->} & \haddockdecltt{[Step]} & \\
\end{tabulary}\par
Convert a translated GTL model into a PROMELA process body.
\par

\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
translateNever\ ::\ Buchi\ {\char 91}Integer{\char 93}\ ->\ {\char 91}Step{\char 93}
\end{tabular}]\haddockbegindoc
Translate a buchi automaton representing a verify expression into a never claim.
\par

\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
type\ AtomCache\ =\ Map\ (GTLAtom\ (Maybe\ String,\ String))\ (Integer,\ Bool,\ String)
\end{tabular}]\haddockbegindoc
A cache that maps atoms to C-functions that represent them.
   The C-functions are encoded by a unique number, whether they are a test- or
   assignment-function and their source code representation.
\par

\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
type\ OutputMapping\ =\ Map\ String\ (Map\ (Maybe\ (String,\ String))\ (Set\ Integer))
\end{tabular}]\haddockbegindoc
A map from component names to output variable informations.
\par

\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
parseGTLAtom
\end{tabular}]\haddockbegindoc
\haddockbeginargs
\haddockdecltt{::} & \haddockdecltt{AtomCache} & A cache of already parsed atoms
 \\
                                                 \haddockdecltt{->} & \haddockdecltt{Maybe (String, OutputMapping)} & Informations about the containing component
 \\
                                                                                                                      \haddockdecltt{->} & \haddockdecltt{GTLAtom (Maybe String, String)} & The atom to parse
 \\
                                                                                                                                                                                            \haddockdecltt{->} & \haddockdecltt{((Integer, Bool), AtomCache)} & \\
\end{tabulary}\par
Parse a GTL atom to a C-function.
   Returns the unique number of the function and whether its a test- or assignment-function.
\par

\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
parseGTLRelation
\end{tabular}]\haddockbegindoc
\haddockbeginargs
\haddockdecltt{::} & \haddockdecltt{BDDConst a} \\
                     \haddockdecltt{=>} & \haddockdecltt{AtomCache} & A cache of parsed atoms
 \\
                                                                      \haddockdecltt{->} & \haddockdecltt{Maybe (String, OutputMapping)} & Informations about the containing component
 \\
                                                                                                                                           \haddockdecltt{->} & \haddockdecltt{Relation} & The relation type to parse
 \\
                                                                                                                                                                                           \haddockdecltt{->} & \haddockdecltt{Expr (Maybe String, String) a} & Left hand side of the relation
 \\
                                                                                                                                                                                                                                                                \haddockdecltt{->} & \haddockdecltt{Expr (Maybe String, String) a} & Right hand side of the relation
 \\
                                                                                                                                                                                                                                                                                                                                     \haddockdecltt{->} & \haddockdecltt{(Integer, Bool, String)} & \\
\end{tabulary}\par
Parse a GTL relation into a C-Function.
   Returns a unique number for the resulting function, whether its a test- or assignment function and
   its source-code representation.
\par

\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
createBDDAssign
\end{tabular}]\haddockbegindoc
\haddockbeginargs
\haddockdecltt{::} & \haddockdecltt{BDDConst a} \\
                     \haddockdecltt{=>} & \haddockdecltt{Integer} & How many temporary variables have been used so far?
 \\
                                                                    \haddockdecltt{->} & \haddockdecltt{String} & The current component name
 \\
                                                                                                                  \haddockdecltt{->} & \haddockdecltt{String} & The name of the target variable
 \\
                                                                                                                                                                \haddockdecltt{->} & \haddockdecltt{Map (Maybe (String, String)) (Set Integer)} & A mapping of output variables
 \\
                                                                                                                                                                                                                                                  \haddockdecltt{->} & \haddockdecltt{Relation} & The relation used to assign the BDD
 \\
                                                                                                                                                                                                                                                                                                  \haddockdecltt{->} & \haddockdecltt{Expr (Maybe String, String) a} & The expression to assign the BDD with
 \\
                                                                                                                                                                                                                                                                                                                                                                       \haddockdecltt{->} & \haddockdecltt{String} & \\
\end{tabulary}\par
Create a BDD assignment
\par

\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
createBDDCompare
\end{tabular}]\haddockbegindoc
\haddockbeginargs
\haddockdecltt{::} & \haddockdecltt{BDDConst a} \\
                     \haddockdecltt{=>} & \haddockdecltt{Integer} & How many temporary variables have been used?
 \\
                                                                    \haddockdecltt{->} & \haddockdecltt{Maybe String} & If the comparision is part of a contract, give the name of the component, otherwise \haddockid{Nothing} \\
                                                                                                                        \haddockdecltt{->} & \haddockdecltt{Relation} & The relation used to compare the BDDs
 \\
                                                                                                                                                                        \haddockdecltt{->} & \haddockdecltt{Expr (Maybe String, String) a} & Expression representing BDD 1
 \\
                                                                                                                                                                                                                                             \haddockdecltt{->} & \haddockdecltt{Expr (Maybe String, String) a} & Expression representing BDD 2
 \\
                                                                                                                                                                                                                                                                                                                  \haddockdecltt{->} & \haddockdecltt{String} & \\
\end{tabulary}\par
Create a comparison operation between two BDD.
\par

\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
class\ BDDConst\ t\ where
\end{tabular}]\haddockbegindoc
A class of types that have a representation as a BDD.
\par

\haddockpremethods{}\textbf{Methods}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
bddConst\ ::\ t\ ->\ String
\end{tabular}]\haddockbegindoc
Convert a value to the BDD C-representation.
\par

\end{haddockdesc}
\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
instance\ BDDConst\ Bool\\instance\ BDDConst\ Int
\end{tabular}]
\end{haddockdesc}
\begin{haddockdesc}
\item[\begin{tabular}{@{}l}
createBDDExpr
\end{tabular}]\haddockbegindoc
\haddockbeginargs
\haddockdecltt{::} & \haddockdecltt{BDDConst a} \\
                     \haddockdecltt{=>} & \haddockdecltt{Integer} & The current number of temporary variables
 \\
                                                                    \haddockdecltt{->} & \haddockdecltt{Maybe String} & The current component
 \\
                                                                                                                        \haddockdecltt{->} & \haddockdecltt{Expr (Maybe String, String) a} & The GTL expression
 \\
                                                                                                                                                                                             \haddockdecltt{->} & \haddockdecltt{([String], [String], Integer, String)} & \\
\end{tabulary}\par
Convert a GTL expression into a C-expression.
   Returns a list of statements that have to be executed before the expression,
   one that has to be executed afterwards, a number of temporary variables used
   and the resulting C-expression.
\par

\end{haddockdesc}
\begin{haddockdesc}
\item[
buildTransProgram\ ::\ GTLSpec\ ->\ TransProgram
]
\end{haddockdesc}